agents:
  car_1:
    role: defender
    algorithm: ftg
    params:
      max_distance: 10.0            # Lidar range cap for preprocessing (meters)
      window_size: 4                # Smoothing window for lidar
      bubble_radius: 3              # Bubble radius around closest obstacle (indices)
      max_steer: 0.42               # Steering limit (radians)
      min_speed: 0.2                # Minimum commanded speed
      max_speed: 0.7                # Maximum commanded speed
      steering_gain: 0.30           # Steering gain on gap offset
      fov: 4.71238898               # Lidar field of view (radians, 270 deg)
      normalized: false             # True if lidar is normalized to [0,1]
      steer_smooth: 0.7             # Steering low-pass (higher = smoother/slower)
      mode: lidar                   # Observation mode (lidar)

      center_bias_gain: 0.0         # Bias toward center of track when gaps are symmetric
      steering_speed_scale: 1.0     # Limits steer at higher speeds
      inside_bias_gain: 0.0         # Bias to hug inside in tight areas
      crawl_steer_ratio: 0.6        # Slow down when steering exceeds this ratio

      preview_horizon: 0.0          # Kinematic preview horizon (seconds)
      preview_samples: 0            # Kinematic preview samples
      dwa_samples: 0                # Dynamic window samples (0 disables)
      dwa_horizon: 0.5              # DWA horizon (seconds)
      dwa_heading_weight: 0.1       # DWA heading weight

      gap_min_range: 0.4            # Min range for valid gap points (meters)
      target_mode: center           # "midgap" or "farthest" target point

      use_disparity_extender: true  # Expand obstacles using disparity extender
      disparity_threshold: 0.35     # Disparity threshold (meters)
      vehicle_width: 0.225          # Vehicle width for disparity extender (meters)
      safety_margin: 0.12           # Extra safety margin (meters)

      no_cutback_enabled: true      # Prevent cutback maneuvers
      cutback_clearance: 0.9        # Clearance required to allow cutback (meters)
      cutback_hold_steps: 8         # Steps to hold cutback decision

      wall_avoid_kick: 0.06         # Bias away from closest wall
      panic_threshold_near: 4.0     # Distance threshold for "near" panic (meters)
      panic_threshold_very_near: 2.0 # Distance threshold for "very near" panic (meters)
      panic_factor_near: 1.1        # Steering scale when near walls
      panic_factor_very_near: 1.3   # Steering scale when very near walls
      evasive_threshold: 1.0        # Distance threshold for evasive override (meters)
      evasive_steer_scale: 0.5      # Max steer scale in evasive mode

      enhanced_gap_scoring: false   # Use weighted gap scoring instead of width only
      gap_score_width_weight: 1.0   # Gap width weight
      gap_score_clearance_weight: 1.0 # Gap clearance weight
      gap_score_center_weight: 0.5  # Bias toward center gaps
      gap_score_curvature_weight: 0.2 # Penalize curvature changes

      u_shape_enabled: false        # Detect U-shapes and slow down
      u_shape_threshold: 0.5        # U-shape detection threshold
      u_shape_crawl_speed: 0.3      # Crawl speed when U-shape detected
