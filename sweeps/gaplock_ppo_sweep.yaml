name: gaplock_ppo_sweep
description: PPO hyperparameter sweep - uncomment parameters to add to search

method: bayes
metric:
  name: car_0/rolling/success_rate
  goal: maximize

project: marl-f110
entity: ahoop004-old-dominion-university

command:
  - ${env}
  - python
  - run_sweep.py
  - --scenario
  - scenarios/v2/gaplock_ppo.yaml

early_terminate:
  type: hyperband
  min_iter: 300
  max_iter: 1000
  s: 2
  eta: 3

parameters:
  episodes:
    value: 1500

  seed:
    distribution: int_uniform
    min: 0
    max: 999999

  # ============================================================================
  # ACTIVE PARAMETERS - Currently being swept
  # ============================================================================

  # Learning rate (discretized)
  agents.car_0.params.lr:
    values: [0.0001, 0.0002]

  # Entropy coefficient (exploration bonus, discretized)
  agents.car_0.params.entropy_coef:
    values: [0.0, 0.01, 0.02, 0.05]

  # PPO clipping parameter (discretized)
  agents.car_0.params.clip_epsilon:
    values: [0.1, 0.2, 0.3]

  # ============================================================================
  # CORE PPO HYPERPARAMETERS - Discretized and commented
  # ============================================================================

  # --- Discount Factor ---
  # Controls how much the agent values future rewards vs immediate rewards
  # Higher = more long-term planning, Lower = more myopic behavior
  # Default: 0.995
  agents.car_0.params.gamma:
    values: [0.99, 0.995, 0.999]

  # --- GAE Lambda (Generalized Advantage Estimation) ---
  # Trades off bias vs variance in advantage estimation
  # Higher = lower variance but more bias, Lower = higher variance but less bias
  # Default: 0.95
  agents.car_0.params.gae_lambda:
    values: [0.90, 0.95, 0.98]

  # --- Value Loss Coefficient ---
  # Weight of value function loss in total loss
  # Higher = emphasize accurate value prediction
  # Default: 0.5
  agents.car_0.params.value_loss_coef:
    values: [0.25, 0.5, 1.0, 2.0]

  # --- Max Gradient Norm (Gradient Clipping) ---
  # Prevents exploding gradients by clipping
  # Lower = more conservative updates, Higher = faster but less stable learning
  # Default: 0.5
  # agents.car_0.params.max_grad_norm:
  #   values: [0.3, 0.5, 1.0, 2.0]

  # ============================================================================
  # TRAINING CONFIGURATION - Discretized and commented
  # ============================================================================

  # --- Number of Epochs ---
  # How many times to iterate over each batch of experience
  # Higher = more learning from each experience but risk overfitting
  # Default: 10
  agents.car_0.params.n_epochs:
    values: [5, 10, 15, 20]

  # --- Batch Size ---
  # Number of samples per minibatch during training
  # Larger = more stable gradients but slower, Smaller = noisier but faster
  # Default: 256
  agents.car_0.params.batch_size:
    values: [64, 128, 256, 512]

  # ============================================================================
  # NETWORK ARCHITECTURE - Discretized and commented
  # ============================================================================

  # --- Hidden Layer Dimensions ---
  # Size and depth of the neural network
  # Larger = more capacity but slower and risk overfitting
  # Default: [256, 256]
  # agents.car_0.params.hidden_dims:
  #   values: [
  #     [128, 128],
  #     [256, 256],
  #     [512, 512],
  #     [256, 256, 256],
  #   ]

  # ============================================================================
  # ALTERNATIVE: CONTINUOUS RANGES
  # ============================================================================
  # Use these instead of discrete values for continuous optimization

  # CONTINUOUS LEARNING RATE
  # agents.car_0.params.lr:
  #   distribution: log_uniform_values
  #   min: 0.00005
  #   max: 0.001

  # CONTINUOUS ENTROPY COEFFICIENT
  # agents.car_0.params.entropy_coef:
  #   distribution: uniform
  #   min: 0.0
  #   max: 0.05

  # CONTINUOUS CLIP EPSILON
  # agents.car_0.params.clip_epsilon:
  #   distribution: uniform
  #   min: 0.1
  #   max: 0.3

  # CONTINUOUS GAMMA
  # agents.car_0.params.gamma:
  #   distribution: uniform
  #   min: 0.99
  #   max: 0.999

  # CONTINUOUS GAE LAMBDA
  # agents.car_0.params.gae_lambda:
  #   distribution: uniform
  #   min: 0.90
  #   max: 0.98

  # CONTINUOUS VALUE LOSS COEF
  # agents.car_0.params.value_loss_coef:
  #   distribution: log_uniform_values
  #   min: 0.25
  #   max: 2.0

  # CONTINUOUS MAX GRAD NORM
  # agents.car_0.params.max_grad_norm:
  #   distribution: log_uniform_values
  #   min: 0.3
  #   max: 2.0

# ============================================================================
# CURRENT CONFIGURATION SUMMARY
# ============================================================================
# Active parameters: 3 (lr, entropy_coef, clip_epsilon)
# Search space: 4 × 4 × 3 = 48 combinations
#
# Scenario baseline (gaplock_ppo.yaml):
#   lr: 0.0005
#   gamma: 0.995
#   gae_lambda: 0.95
#   clip_epsilon: 0.2
#   entropy_coef: 0.02
#   value_loss_coef: 0.5
#   max_grad_norm: 0.5
#   hidden_dims: [256, 256]
#   batch_size: 256
#   n_epochs: 10
# ============================================================================
