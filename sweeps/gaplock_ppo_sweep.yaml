name: gaplock_ppo_sweep
description: PPO hyperparameter sweep - uncomment parameters to add to search

method: bayes
metric:
  name: car_0/rolling/avg_reward
  goal: maximize

project: marl-f110
entity: ahoop004-old-dominion-university

command:
  - ${env}
  - python
  - run_sweep.py
  - --scenario
  - scenarios/v2/gaplock_ppo.yaml

early_terminate:
  type: hyperband
  min_iter: 300
  max_iter: 1000
  s: 2
  eta: 3

parameters:
  episodes:
    value: 1000

  seed:
    distribution: int_uniform
    min: 0
    max: 999999

  # ============================================================================
  # ACTIVE PARAMETERS - Currently being swept
  # ============================================================================

  # Learning rate (discretized)
  agents.car_0.params.lr:
    values: [0.0001, 0.0002, 0.0005, 0.001]

  # Entropy coefficient (exploration bonus, discretized)
  agents.car_0.params.entropy_coef:
    values: [0.0, 0.01, 0.02, 0.05]

  # PPO clipping parameter (discretized)
  agents.car_0.params.clip_epsilon:
    values: [0.1, 0.2, 0.3]

  # ============================================================================
  # FIXED PARAMETERS - Using good defaults (uncomment to re-enable sweeping)
  # ============================================================================

  # GAE lambda (advantage estimation)
  # Fixed to 0.95; uncomment to sweep
  # agents.car_0.params.gae_lambda:
  #   values: [0.9, 0.95, 0.98]

  # Value function loss coefficient
  # agents.car_0.params.vf_coef:
  #   values: [0.5, 1.0, 2.0]

  # Max gradient norm (for gradient clipping)
  # agents.car_0.params.max_grad_norm:
  #   values: [0.5, 1.0, 2.0]

  # Number of epochs per update
  # agents.car_0.params.n_epochs:
  #   values: [5, 10, 15]

  # Minibatch size
  # agents.car_0.params.batch_size:
  #   values: [64, 128, 256]

  # ============================================================================
  # ALTERNATIVE CONFIGURATIONS - Continuous ranges
  # ============================================================================

  # CONTINUOUS LEARNING RATE
  # agents.car_0.params.lr:
  #   distribution: log_uniform_values
  #   min: 0.0001
  #   max: 0.001

  # CONTINUOUS ENTROPY COEF
  # agents.car_0.params.entropy_coef:
  #   distribution: uniform
  #   min: 0.0
  #   max: 0.05

  # CONTINUOUS CLIP EPSILON
  # agents.car_0.params.clip_epsilon:
  #   distribution: uniform
  #   min: 0.1
  #   max: 0.3

# ============================================================================
# CURRENT CONFIGURATION SUMMARY
# ============================================================================
# Active parameters: 3 (lr, entropy_coef, clip_epsilon)
# Search space: 4 × 4 × 3 = 48 combinations
# Fixed in scenario: gae_lambda=0.95, vf_coef=0.5, max_grad_norm=0.5
# ============================================================================
